{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="max-w-5xl mx-auto mt-10 bg-white border border-sky-100 rounded-2xl shadow-lg overflow-hidden">

  <!-- Header Gradient -->
  <div class="bg-gradient-to-r from-sky-400 via-sky-500 to-blue-600 p-6 text-white flex justify-between items-center">
    <div>
      <h1 class="text-2xl font-bold tracking-tight">{{ products.name }}</h1>
      <p class="text-sky-100 text-sm mt-1">Official Manchester City Product</p>
    </div>
    <a href="{% url 'main:show_main' %}" 
       class="text-sm font-medium bg-white text-sky-700 px-4 py-2 rounded-lg shadow hover:bg-sky-50 hover:text-blue-700 transition">
      ‚Üê Back to Products
    </a>
  </div>

  <div class="grid md:grid-cols-2 gap-10 p-8 bg-gradient-to-br from-white via-sky-50 to-white">

    <!-- Product Image -->
    <div class="flex justify-center items-center bg-white rounded-xl border border-sky-100 shadow-md hover:shadow-xl transition transform hover:-translate-y-1">
      {% if products.thumbnail %}
        <img src="{{ products.thumbnail }}" alt="{{ products.name }}" class="rounded-lg object-cover max-h-[450px] w-full">
      {% else %}
        <img src="{% static 'image/no-products.png' %}" alt="No image available" class="rounded-lg object-cover max-h-[450px] w-full">
      {% endif %}
    </div>

    <!-- Product Info -->
    <div class="flex flex-col justify-between">
      <div>
        <!-- Category -->
        <div class="mb-4">
          <span class="inline-flex items-center bg-sky-100 text-sky-700 text-sm font-semibold px-3 py-1 rounded-full shadow-sm">
            ‚öΩ {{ products.get_category_display }}
          </span>
        </div>

        <!-- Price -->
        <p class="text-3xl font-extrabold text-blue-600 mb-3 drop-shadow-sm">
          Rp {{ products.price }}
        </p>

        <!-- Description -->
        <p class="text-gray-700 leading-relaxed mb-6">
          {{ products.description }}
        </p>

        <!-- Stock & Details -->
        <div class="bg-white border border-sky-100 rounded-xl p-4 shadow-inner space-y-1">
          <p><strong class="text-sky-800">Stock:</strong> {{ products.stock }}</p>
          <p><strong class="text-sky-800">Sold:</strong> {{ products.products_solds }}</p>
          {% if products.is_featured %}
            <p><strong class="text-sky-800">Featured:</strong> üåü <span class="text-sky-700 font-semibold">Yes</span></p>
          {% endif %}
          {% if products.is_popular %}
            <p class="text-green-600 font-semibold">üî• Popular Item!</p>
          {% endif %}
        </div>

        <!-- Buy Section -->
        {% if products.stock > 0 %}
          <form method="POST" action="{% url 'main:purchase_product' products.id %}" class="mt-6 flex flex-wrap gap-3 items-center">
            {% csrf_token %}
            <label for="quantity" class="text-gray-700 font-medium">Quantity:</label>
            <input
              type="number"
              name="quantity"
              id="quantity"
              value="1"
              min="1"
              max="{{ products.stock }}"
              class="border border-sky-200 rounded-lg px-3 py-2 w-24 focus:ring-2 focus:ring-sky-400 focus:outline-none"
            >
            <button
              type="submit"
              class="bg-sky-500 hover:bg-sky-600 text-white font-semibold px-6 py-2 rounded-lg shadow hover:shadow-lg transition duration-200"
            >
              üõí Buy
            </button>
          </form>
        {% else %}
          <p class="mt-5 text-red-600 font-medium bg-red-50 border border-red-200 rounded-lg px-3 py-2 w-fit">
            ‚ùå Out of Stock
          </p>
        {% endif %}
      </div>

      <!-- Footer -->
      <p class="mt-8 text-sm text-gray-500 border-t pt-4">
        Posted by <span class="font-medium text-gray-700">{{ products.user.username|default:"Anonymous" }}</span>
      </p>
    </div>
  </div>
</div>
{% endblock %}
