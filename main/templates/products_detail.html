{% extends 'base.html' %}
{% block content %}
<p><a href="{% url 'main:show_main' %}"><button>‚Üê Back to Products List</button></a></p>

<h1>{{ products.name }}</h1>
<p>
  <b>{{ products.get_category_display }}</b>
  {% if products.is_featured %} | <b>Featured</b>{% endif %}
  {% if products.is_popular %} | <b>Popular</b>{% endif %}
  | <i>{{ products.created_at|date:"d M Y H:i" }}</i> 
  | Solds: {{ products.products_solds }} 
  | Stock: {{ products.stock }}
</p>

{% if products.thumbnail %}
<img src="{{ products.thumbnail }}" alt="Products thumbnail" width="300">
<br /><br />
{% endif %}

<p>{{ products.description }}</p>

{% if products.stock > 0 %}
<form method="post" action="{% url 'main:purchase_product' products.id %}">
    {% csrf_token %}
    <label for="quantity">Quantity:</label>
    <input type="number" id="quantity" name="quantity" value="1" min="1" max="{{ products.stock }}">
    <button type="submit">Buy Now</button>
</form>
{% endif %}

{% if products.user %}
    <p>Author: {{ products.user.username }}</p>
{% else %}
    <p>Author: Anonymous</p>
{% endif %}

{% if user.is_authenticated %}
    {% if products.user %}
        {% if user == products.user %}
            <form method="post" action="{% url 'main:delete_product' products.id %}" style="margin-top:10px;">
                {% csrf_token %}
                <button type="submit" onclick="return confirm('Yakin mau hapus produk ini?')" style="background:red; color:white;">
                    Delete Product
                </button>
            </form>
        {% endif %}
    {% else %}
        <form method="post" action="{% url 'main:delete_product' products.id %}" style="margin-top:10px;">
    {% csrf_token %}
    <button type="submit" onclick="return confirm('Yakin mau hapus produk ini?')" style="background:red; color:white;">
        Delete Product
    </button>
</form>

    {% endif %}
{% endif %}

{% endblock content %}
